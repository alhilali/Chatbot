{"version":3,"sources":["../../src/pages/chat/chat.module.ts","../../src/pages/chat/chat.ts"],"names":[],"mappings":"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","file":"0.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { ChatPage } from './chat';\n\n@NgModule({\n  declarations: [\n    ChatPage,\n  ],\n  imports: [\n    IonicPageModule.forChild(ChatPage),\n  ],\n})\nexport class ChatPageModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/chat/chat.module.ts","import { ConversationServiceProvider } from \"./../../providers/conversation-service/conversation-service\";\nimport { IonicPage, NavController, Content } from 'ionic-angular';\nimport { Component, ViewChild } from '@angular/core';\n/**\n * Generated class for the ChatPage page.\n *\n * See https://ionicframework.com/docs/components/#navigation for more info on\n * Ionic pages and navigation.\n */\n\n@IonicPage()\n@Component({\n  selector: 'page-chat',\n  templateUrl: 'chat.html',\n})\nexport class ChatPage {\n  @ViewChild(Content) content: Content;\n  message: string = \"\";\n  messages: Array<Message>;\n  restaurants: Array<Restaurant>;\n\n  constructor(public navCtrl: NavController,\n    private conversationService: ConversationServiceProvider) {\n    this.messages = new Array<Message>();\n  }\n\n  ionViewDidEnter() {\n    this.messages = new Array<Message>();\n    this.restaurants = new Array<Restaurant>();\n    this.conversationService.sendMessage(\"\").subscribe(\n      data => {\n        console.log(data);\n        this.updateConversation(data);\n      },\n      error => {\n        console.log(error);\n      }\n    )\n    this.generateMenue('كنتاكي')\n  }\n\n  generateMenue(restaurantName: string) {\n    const restaurant = new Restaurant(restaurantName, 'https://upload.wikimedia.org/wikipedia/en/thumb/b/bf/KFC_logo.svg/1200px-KFC_logo.svg.png');\n    restaurant.addMenuItem('وجبة تويستر', 15, 'https://ocs-pl.oktawave.com/v1/AUTH_876e5729-f8dd-45dd-908f-35d8bb716177/amrest-web-ordering/img/KFC/Web/kfc_pl/assets/uploads/twister-menu.jpg');\n    restaurant.addMenuItem('وجبة مايتي زينجر', 20, 'https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQ39B3QamHch8oECAqWnQ2gx68UQfbX6kQmkOL-5C5YwkJ6vLtQ');\n    restaurant.addMenuItem('وجبة كريسبي ستريبس', 19, 'https://ocs-pl.oktawave.com/v1/AUTH_876e5729-f8dd-45dd-908f-35d8bb716177/amrest-web-ordering/img/KFC/Web/kfc_pl/assets/uploads/strips-menu-1.jpg');\n    restaurant.addMenuItem('وجبة مطافي', 18, 'https://ocs-pl.oktawave.com/v1/AUTH_876e5729-f8dd-45dd-908f-35d8bb716177/amrest-web-ordering/img/KFC/Web/kfc_pl/assets/uploads/longer-menu-1.jpg');\n    this.restaurants.push(restaurant);\n  }\n\n  loadMoreItems(restaurant: Restaurant) {\n    restaurant.addMenuItem('وجبة دينر', 16, 'https://ocs-pl.oktawave.com/v1/AUTH_876e5729-f8dd-45dd-908f-35d8bb716177/amrest-web-ordering/img/KFC/Web/kfc_pl/assets/uploads/bites_Big_menu.jpg');\n  }\n\n  send() {\n    this.messages.push(new Message(this.message, false));\n    setTimeout(() => {\n      this.content.scrollToBottom(200);\n    });\n\n    this.conversationService.sendMessage(this.message).subscribe(\n      data => {\n        if (data.entities[0].entity == 'مطعم') {\n          this.updateConversationWithRestaurant(this.restaurants[0]);\n        }\n        this.updateConversation(data);\n      },\n      error => {\n        console.log(error);\n      }\n    )\n\n    this.message = \"\";\n  }\n\n  private updateConversationWithRestaurant(restaurant: Restaurant) {\n    this.messages.push(new Message(\"\", true, true, restaurant));\n  }\n\n  private updateConversation(data: any) {\n    let msg = \"\";\n\n    if (data.output.text.length >= 1) {\n      msg = data.output.text.join(\" \");\n    } else if (data.output.text.length == 1) {\n      msg = data.output.text[0];\n    }\n\n    this.messages.push(new Message(msg, true));\n\n    setTimeout(() => {\n      this.content.scrollToBottom(300);\n    });\n  }\n\n  footerTouchStart(event) {\n    if (event.target.localName !== \"input\") {\n      event.preventDefault();\n    } else {\n      setTimeout(() => {\n        this.content.scrollToBottom();\n      }, 300);\n    }\n  }\n\n  touchSendButton(event: Event) {\n    event.preventDefault();\n    this.send();\n  }\n\n}\n\nexport class Message {\n  content: string;\n  isWatson: boolean;\n  timestamp: string;\n  isRestaurant?: boolean;\n  restaurant?: Restaurant;\n\n  constructor(content: string, isWatson: boolean,\n    type?: boolean, restaurant?: Restaurant) {\n    this.content = content;\n    this.isWatson = isWatson;\n    const date = new Date();\n    this.timestamp = date.toLocaleDateString() + ' ' + date.toLocaleTimeString();\n    if (type) {\n      this.restaurant = restaurant;\n      this.isRestaurant = type;\n    } else type = false;\n  }\n}\n\nexport class MenuItem {\n  name: string;\n  price: number;\n  quantitiy: number;\n  image: string;\n\n  constructor(name: string, price: number, image: string) {\n    this.name = name;\n    this.price = price;\n    this.image = image;\n  }\n}\n\n\nexport class Restaurant {\n  name: string;\n  menu: Array<MenuItem>;\n  logoImage: string;\n\n  constructor(name: string, logo?: string) {\n    this.name = name;\n    this.menu = new Array<MenuItem>();\n    if (logo) this.logoImage = logo;\n  }\n\n  addMenuItem(name: string, price: number, image: string) {\n    const menuItem = new MenuItem(name, price, image);\n    this.menu.push(menuItem);\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/chat/chat.ts"],"sourceRoot":""}